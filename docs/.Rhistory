require(tidyverse)
require(vtable)
require(labelled)
require(gtsummary)
require(janitor)
require(dplyr)
require(psych)
# library(rio)
# library(car)
# library(summarytools)
require(Hmisc)
# install.packages("simr")
# library(simr)
library(glmmTMB)
# getwd()
# setwd ("C:/Users/Nicholas Bishop/OneDrive/work files/UArizona/grants/multimorbidity/data and analysis/grant proposals/R01 FEB 25")
# getwd()
options(scipen = 999)
load("hrs_hcap_2.Rdata")
load("mhas_hcap_2.Rdata")
hrs_mhas_hcap <- bind_rows(hrs_hcap_2, mhas_hcap_2) %>%
dplyr::filter (age_hcap != 999 & weight != 0 & !is.na(educ) & !is.na(fgcp_bayes3)) %>%
dplyr::mutate(ed = as.numeric(isced_level_v2),  # Ensure ed is numeric
ed_cent = round(ed - mean(ed, na.rm = TRUE), 3),  # Center ed)
age_cent = round(age_hcap - mean(age_hcap, na.rm = TRUE), 3),
status = factor(status, levels = c("HRS, US born",
"HRS, immigrant",
"MHAS, migrant",
"MHAS, non-migrant"))
)
sumtable(hrs_mhas_hcap, group = "study")
# re scaling weights proportionally
pop_size_hrs <- hrs_mhas_hcap %>%
dplyr::filter(study == 'HRS') %>%
group_by(imm_flag_n) %>%
summarise(weight_sum = sum(weight)) %>%
as_tibble()
pop_size_hrs
pop_size_mhas <- hrs_mhas_hcap %>%
dplyr::filter(study == 'MHAS') %>%
group_by(imm_age_f) %>%
summarise(weight_sum = sum(weight)) %>%
as_tibble()
pop_size_mhas
# Hispanic US residents aged 65 and older in 2016: 49.2 million total, 8% identify as Hispanic = 3.936 million Hispanics (2017 Profile of Older Americans)
# In 2019, 61.5% of all Hispanics indicated they were of Mexican origin (https://www.pewresearch.org/science/2022/06/14/a-brief-statistical-portrait-of-u-s-hispanics/)
# 3.936*.615=2.42064
# From HRS HCAP
# 1110092+1264380 = 2374472
# Mexico residents aged 65 and older in 2016: 8,315,035 (https://data.worldbank.org/indicator/SP.POP.65UP.TO?locations=MX)
# 888428+7402258= 8290686
# (3) Standardize weights so that the contribution of each HCAP study sample is proportionate to its sample size
# (i.e., the sum of the weights for each sample is equal to the sample size).
sumtable(hrs_mhas_hcap, group = "study")
hrs_mhas_hcap_2 <- hrs_mhas_hcap %>%
dplyr::mutate (wght_std = case_when(study == "HRS" & status == "HRS, immigrant"  ~ weight * (110 / 1110092),
study == "HRS" & status == "HRS, US born"  ~ weight * (123 / 1264380),
study == "MHAS" & status == "MHAS, migrant"  ~ weight * (141 / 888428),
study == "MHAS" & status == "MHAS, non-migrant"  ~ weight * (1088 / 7402258)))
pop_size_std <- hrs_mhas_hcap_2 %>%
group_by(study, status) %>%
summarise(weight_sum = sum(wght_std)) %>%
as_tibble()
pop_size_std
# close but not perfect
# study status            weight_sum
# 1 HRS   HRS, US born            123
# 2 HRS   HRS, immigrant          110
# 3 MHAS  MHAS, migrant           140.
# 4 MHAS  MHAS, non-migrant      1076.
sumtable(hrs_mhas_hcap_2)
sumtable(hrs_mhas_hcap_2, group = "status")
sumtable(hrs_mhas_hcap_2)
# load packages  ----------------------------------------------------------
library(dplyr)
library(haven)
library(vtable)
library(tidyverse)
library(janitor)
library(crosstable)
install.packages("srvyr")
library(srvyr)
library(gtsummary)
library(sjlabelled)
library(sjPlot)
library(vtable)
library(glmmTMB)
library(labelled)
naws_1 <- haven::read_sas("C:/Users/Nicholas Bishop/Box/NAWS 2.0/aging_health_analyses/data/naws_all.sas7bdat") %>%
janitor::clean_names(., "snake") %>%
dplyr::mutate(yr_grp_2 = as.factor(case_when(fy %in% c(1989,1990) ~ "89-90",
fy %in% c(1991,1992) ~ "91-92",
fy %in% c(1993,1994) ~ "93-94",
fy %in% c(1995,1996) ~ "95-96",
fy %in% c(1997,1998) ~ "97-98",
fy %in% c(1999,2000) ~ "99-00",
fy %in% c(2001,2002) ~ "01-02",
fy %in% c(2003,2004) ~ "03-04",
fy %in% c(2005,2006) ~ "05-06",
fy %in% c(2007,2008) ~ "07-08",
fy %in% c(2009,2010) ~ "09-10",
fy %in% c(2011,2012) ~ "11-12",
fy %in% c(2013,2014) ~ "13-14",
fy %in% c(2015,2016) ~ "15-16",
fy %in% c(2017,2018) ~ "17-18",
fy %in% c(2019,2020) ~ "19-20")),
yr_grp_2 = factor(yr_grp_2, levels = c("89-90",
"91-92",
"93-94",
"95-96",
"97-98",
"99-00",
"01-02",
"03-04",
"05-06",
"07-08",
"09-10",
"11-12",
"13-14",
"15-16",
"17-18",
"19-20")))
#Load in all packages
library(haven)
library(tidyverse)
library(janitor)
library(dplyr)
library(psych)
library(rio)
library(car)
library(summarytools)
library(Hmisc)
library(labelled)
library(vtable)
# weighted quartiles
library(dineq)
library(MplusAutomation)
All_Output <- readModels("C:/Users/Nicholas Bishop/Box/MEMORABLE project BOX/Kealie/mplus/dep model analysis/updated 091724")
warnings()
combined_model_building <- do.call(dplyr::bind_rows, lapply(1:length(All_Output), function(m) {
df <- All_Output[[m]]$parameters$unstandardized
df$model <- names(All_Output)[m]
return(df)
}))
summaries_model_building  <- do.call(dplyr::bind_rows, lapply(1:length(All_Output), function(m) {
df <- All_Output[[m]]$summaries
df$model <- names(All_Output)[m]
return(df)
}))
write.table(combined_model_building,"C:/Users/Nicholas Bishop/Box/MEMORABLE project BOX/Kealie/mplus/dep model analysis/updated 091724/mod estimates 091724.csv",sep=",",row.names=FALSE)
write.table(summaries_model_building,"C:/Users/Nicholas Bishop/Box/MEMORABLE project BOX/Kealie/mplus/dep model analysis/updated 091724/mod summaries 091724.csv",sep=",",row.names=FALSE)
combined_model_building_std <- do.call(dplyr::bind_rows, lapply(1:length(All_Output), function(m) {
df <- All_Output[[m]]$parameters$stdyx.standardized
df$model <- names(All_Output)[m]
return(df)
}))
View(combined_model_building_std)
write.table(combined_model_building_std,"C:/Users/Nicholas Bishop/Box/MEMORABLE project BOX/Kealie/mplus/dep model analysis/updated 091724/mod estimates 091724 std.csv",sep=",",row.names=FALSE)
setwd("C:/Users/Nicholas Bishop/Documents/GitHub/home/docs")
mod_output <- readModels("C:/Users/Nicholas Bishop/Box/MEMORABLE project BOX/Kealie/mplus/dep model analysis/updated 091724")
combined_results2 <- do.call(dplyr::bind_rows, lapply(1:length(mod_output), function(m) {
df <- mod_output[[m]]$parameters$unstandardized
df$model <- names(mod_output)[m]
return(df)
}))
sumtable(combined_results2)
combined_results2 <- combined_results2 %>%
dplyr::mutate(model = as.factor(model))
sumtable(combined_results2)
# quadratic with age
# create initial dataset from mplus results
mplus_est_q <- combined_results2 %>% dplyr::filter(model == "X1..dep.lgm.mm.combo.out" &
paramHeader %in% c("DEP_I.ON", "DEP_S.ON", "DEP_Q.ON", "Intercepts") &
param %in% c("ART_1_12",
"HBP_1_12",
"OTH_SIN_CO",
"HBP_ART",
"HBP_HRT_AR",
"HBP_DIA_AR",
"HBP_DIA_HR",
"HBP_CAN_AR",
"HBP_DIA",
"HRT_ART",
"CAN_ART",
"HBP_LNG_AR",
"OTH_COMB",
"DEP_I",
"DEP_S",
"DEP_Q"
)) %>%
dplyr::select(-model, -est_se, -pval) %>%
clean_names(., "snake") %>%
dplyr::mutate(param_header = tolower(param_header),
param_header = str_replace(param_header, ".on", ""),
param = tolower(param),
param = case_when(param  =="ART_1_12" ~ "ARTH only",
param  =="HBP_1_12" ~ "HBP only",
param  =="OTH_SIN_CO" ~ "Other single condition",
param  =="HBP_ART" ~ "HBP + ARTH",
param  =="HBP_HRT_AR" ~ "HBP + HRT + ARTH",
param  =="HBP_DIA_AR" ~ "HBP + DIA + ARTH",
param  =="HBP_DIA_HR" ~ "HBP + DIA + HRT + ARTH",
param  =="HBP_CAN_AR" ~ "HBP + CAN + ARTH",
param  =="HBP_DIA" ~ "HBP + DIA",
param  =="HRT_ART" ~ "HRT + ARTH",
param  =="CAN_ART" ~ "CAN + ARTH",
param  =="HBP_LNG_AR" ~ "HBP + LUNG + ARTH",
param  =="OTH_COMB" ~ "Other combination of 2+ conditions",
TRUE ~ param))
est_wide <- mplus_est_q %>%
pivot_wider(names_from = param_header, values_from = c(est, se)) %>%
dplyr::mutate(j_v = 1)
int_i <- mplus_est_q %>% dplyr::filter(param_header == "intercepts" & param == "dep_i") %>%
dplyr::mutate(j_v = 1) %>% rename (dep_i_int = est, dep_i_se = se) %>%
dplyr::select(j_v, dep_i_int, dep_i_se)
int_s <- mplus_est_q %>% dplyr::filter(param_header == "intercepts" & param == "dep_s") %>%
dplyr::mutate(j_v=1) %>% rename (dep_s_int = est, dep_s_se = se) %>%
dplyr::select(j_v, dep_s_int, dep_s_se)
int_q <- mplus_est_q %>% dplyr::filter(param_header == "intercepts" & param == "dep_q") %>%
dplyr::mutate(j_v=1) %>% rename (dep_q_int = est, dep_q_se = se) %>%
dplyr::select(j_v, dep_q_int, dep_q_se)
est_wide_int_q <- left_join(est_wide, int_i, by = c("j_v")) %>%
left_join(., int_s, by = c("j_v")) %>%
left_join(., int_q, by = c("j_v"))
# create a row for the reference category (no conditions) that can be used for plotting and bind with other data
est_wide_ref_q <- mplus_est_q %>%
dplyr::filter(param_header == "intercepts") %>%
pivot_wider(names_from = param, values_from = c(est, se)) %>%
dplyr::mutate(j_v = 1) %>%
rename (param = param_header) %>%
dplyr::mutate(param = case_when (param == "intercepts" ~ "No condition"),
dep_i_int = est_dep_i,
dep_s_int = est_dep_s,
dep_q_int = est_dep_q,
dep_i_se = se_dep_i,
dep_s_se = se_dep_s,
dep_q_se = se_dep_q)
# vtable(est_wide_ref_q)
est_wide_int2_q <- bind_rows(est_wide_int_q, est_wide_ref_q)
est_wide2_q <- est_wide_int2_q %>%
mutate(int_i = case_when (param == "No condition" ~  dep_i_int,
TRUE ~ dep_i_int + est_dep_i),
slp_i = case_when (param == "No condition" ~ dep_s_int,
TRUE ~ dep_s_int + est_dep_s),
qua_i = case_when (param == "No condition" ~  dep_q_int,
TRUE ~ dep_q_int + est_dep_q),
pred_12 = int_i + (slp_i*0) + (qua_i*0^2),
pred_13 = int_i + (slp_i*1) + (qua_i*1^2),
pred_14 = int_i + (slp_i*2) + (qua_i*2^2),
pred_15 = int_i + (slp_i*3) + (qua_i*3^2),
pred_16 = int_i + (slp_i*4) + (qua_i*4^2),
pred_17 = int_i + (slp_i*5) + (qua_i*5^2),
pred_18 = int_i + (slp_i*6) + (qua_i*6^2),
pred_19 = int_i + (slp_i*7) + (qua_i*7^2),
pred_20 = int_i + (slp_i*8) + (qua_i*8^2),
int_i_lci = case_when (param == "No condition" ~  dep_i_int - (1.96*dep_i_se),
TRUE ~ (dep_i_int - (1.96*dep_i_se)) + (est_dep_i - (1.96*se_dep_i))),
slp_i_lci = case_when (param == "No condition" ~ dep_s_int - (1.96*dep_s_se),
TRUE ~ (dep_s_int - (1.96*dep_s_se)) + (est_dep_s - (1.96*se_dep_i))),
qua_i_lci = case_when (param == "No condition" ~  dep_q_int - (1.96*dep_q_se),
TRUE ~ (dep_q_int - (1.96*dep_q_se)) + (est_dep_q - (1.96*se_dep_q))),
pred_lci_12 = int_i_lci + (slp_i_lci*0) + (qua_i_lci*0^2),
pred_lci_13 = int_i_lci + (slp_i_lci*1) + (qua_i_lci*1^2),
pred_lci_14 = int_i_lci + (slp_i_lci*2) + (qua_i_lci*2^2),
pred_lci_15 = int_i_lci + (slp_i_lci*3) + (qua_i_lci*3^2),
pred_lci_16 = int_i_lci + (slp_i_lci*4) + (qua_i_lci*4^2),
pred_lci_17 = int_i_lci + (slp_i_lci*5) + (qua_i_lci*5^2),
pred_lci_18 = int_i_lci + (slp_i_lci*6) + (qua_i_lci*6^2),
pred_lci_19 = int_i_lci + (slp_i_lci*7) + (qua_i_lci*7^2),
pred_lci_20 = int_i_lci + (slp_i_lci*8) + (qua_i_lci*8^2),
int_i_uci = case_when (param == "No condition" ~  dep_i_int + (1.96*dep_i_se),
TRUE ~ (dep_i_int + (1.96*dep_i_se)) + (est_dep_i + (1.96*se_dep_i))),
slp_i_uci = case_when (param == "No condition" ~ dep_s_int + (1.96*dep_s_se),
TRUE ~ (dep_s_int + (1.96*dep_s_se)) + (est_dep_s + (1.96*se_dep_i))),
qua_i_uci = case_when (param == "No condition" ~  dep_q_int + (1.96*dep_q_se),
TRUE ~ (dep_q_int + (1.96*dep_q_se)) + (est_dep_q + (1.96*se_dep_q))),
pred_uci_12 = int_i_uci + (slp_i_uci*0) + (qua_i_uci*0^2),
pred_uci_13 = int_i_uci + (slp_i_uci*1) + (qua_i_uci*1^2),
pred_uci_14 = int_i_uci + (slp_i_uci*2) + (qua_i_uci*2^2),
pred_uci_15 = int_i_uci + (slp_i_uci*3) + (qua_i_uci*3^2),
pred_uci_16 = int_i_uci + (slp_i_uci*4) + (qua_i_uci*4^2),
pred_uci_17 = int_i_uci + (slp_i_uci*5) + (qua_i_uci*5^2),
pred_uci_18 = int_i_uci + (slp_i_uci*6) + (qua_i_uci*6^2),
pred_uci_19 = int_i_uci + (slp_i_uci*7) + (qua_i_uci*7^2),
pred_uci_20 = int_i_uci + (slp_i_uci*8) + (qua_i_uci*8^2)
)
# create long dataset for plotting
est_long_q <- est_wide2_q %>%
dplyr::select(param, pred_12:pred_20) %>%
gather(year, est, pred_12:pred_20, factor_key=TRUE) %>%
dplyr::filter(!param %in% c("dep_i", "dep_s", "dep_q")) %>%
mutate(year = as.numeric(str_replace_all(year, "pred_", "")),
est = as.numeric(est))
est_long_q_lci <- est_wide2_q %>%
dplyr::select(param, pred_lci_12:pred_lci_20) %>%
gather(year, est, pred_lci_12:pred_lci_20, factor_key=TRUE) %>%
dplyr::filter(!param %in% c("dep_i", "dep_s", "dep_q")) %>%
mutate(year = as.numeric(str_replace_all(year, "pred_lci_", "")),
lci = as.numeric(est))  %>%
dplyr::select(-est)
est_long_q_uci<- est_wide2_q %>%
dplyr::select(param, pred_uci_12:pred_uci_20) %>%
gather(year, est, pred_uci_12:pred_uci_20, factor_key=TRUE) %>%
dplyr::filter(!param %in% c("dep_i", "dep_s", "dep_q")) %>%
mutate(year = as.numeric(str_replace_all(year, "pred_uci_", "")),
uci = as.numeric(est)) %>%
dplyr::select(-est)
vtable(est_long_q)
est_all <- left_join(est_long_q, est_long_q_lci, by = c("param", "year")) %>%
left_join(., est_long_q_uci, by = c("param", "year")) %>%
dplyr::mutate(param = as.factor(param))
sumtable(est_all)
# all estimates with confidence intervals
# hbp_dia_hr is actually hbp_dia_hrt_art
est_all_2 <- est_all %>%
mutate(param = factor(param, levels=c("No condition",
"art_1_12",
"hbp_1_12",
"oth_sin_co",
"hbp_art",
"hbp_dia",
"hrt_art",
"can_art",
"hbp_hrt_ar",
"hbp_dia_ar",
"hbp_can_ar",
"hbp_lng_ar",
"hbp_dia_hr",
"oth_comb")))
sumtable(est_all_2)
p0 <- ggplot(est_all_2, aes(x = year, y = est, linetype = param)) +
guides(fill = none) +
geom_line(aes(color=param), linewidth=0.7) +
# theme_bw() +
theme(legend.position = "bottom",
legend.background = element_rect(fill = "white", color = "black"),
legend.key.height= unit(.2, 'cm'), legend.key.width= unit(2, 'cm'),
# panel.grid.major = element_blank(),
# panel.grid.minor = element_blank(),
text=element_text(size=14, family="serif")) +
scale_linetype_manual(values = c("solid", "dashed", "solid", "dashed", "solid", "dashed",
"solid", "dashed", "solid", "dashed", "solid", "dashed",
"solid", "dashed"),
labels = c("No condition",
"ARTH only",
"HTN only",
"Other single condition",
"ARTH + HTN",
"HTN + DIA",
"ARTH + HRT",
"ARTH + CAN",
"ARTH + HTN + HRT",
"ARTH + HTN + DIA",
"ARTH + HTN + CAN",
"ARTH + HTRM + LUNG",
"ARTH + HTN + DIA + HRT",
"Other combination of 2+ conditions")) +
scale_color_manual(values = c("#AA4A44", "#734f96", "#777B7E", "#276C8D", "#734f96", "#1e3d59",
"#808000",  "#000000", "#FA8072", "#AA4A44", "#734f96",
"#777B7E", "#276C8D", "#734f96"),
labels = c("No condition",
"ARTH only",
"HTN only",
"Other single condition",
"ARTH + HTN",
"HTN + DIA",
"ARTH + HRT",
"ARTH + CAN",
"ARTH + HTN + HRT",
"ARTH + HTN + DIA",
"ARTH + HTN + CAN",
"ARTH + HTRM + LUNG",
"ARTH + HTN + DIA + HRT",
"Other combination of 2+ conditions")) +
ylim(1, 3) +
labs(x = "Year", y = "HRS-modified CESD") +
theme(legend.title=element_blank()) +
theme(panel.background = element_rect(fill = 'white', color = 'black'))
p0
pd <- position_dodge(0.1)
p0_1 <- p0 + geom_errorbar(aes(ymin=lci, ymax=uci), width=.01, position=pd, linewidth=.5)
p0_1
p0_1
View(est_all_2)
# baseline depressive symptoms estimates
mplus_est_fp <- combined_model_building2 %>% dplyr::filter(model == "X1..dep.lgm.mm.combo.emmeans.int.v2.out" &
paramHeader %in% c("New.Additional.Parameters") &
param %in% c("N_C_E",
"A_E",
"H_E",
"O_S_E",
"H_A_E",
"A_HR_A_E",
"H_D_A_E",
"H_D_HR_A",
"H_C_A_E",
"H_D_E",
"HR_A_E",
"C_A_E",
"H_L_A_E",
"O_CO_E"
)) %>%
dplyr::select(paramHeader, param, est, se) %>%
clean_names(., "snake") %>%
dplyr::mutate(param = case_when(param == "N_C_E" ~ "No condition",
param == "A_E" ~ "ARTH only",
param == "H_E" ~ "HTN only",
param == "O_S_E" ~ "Other single condition",
param == "H_A_E" ~ "ARTH + HTN",
param == "A_HR_A_E" ~ "ARTH + HTN + HRT",
param == "H_D_A_E" ~ "ARTH + HTN + DIA",
param == "H_D_HR_A" ~ "ARTH + HTN + DIA + HRT",
param == "H_C_A_E" ~ "ARTH + HTN + CAN",
param == "H_D_E" ~ "HTN + DIA",
param == "HR_A_E" ~ "ARTH + HRT",
param == "C_A_E" ~ "ARTH + CAN",
param == "H_L_A_E" ~ "ARTH + HTN + LUNG",
param == "O_CO_E" ~ "Other combination of 2+ conditions",
TRUE ~ param),
param = factor(param, levels = c("No condition",
"ARTH only",
"HTN only",
"Other single condition",
"ARTH + HTN",
"HTN + DIA",
"ARTH + HRT",
"ARTH + CAN",
"ARTH + HTN + HRT",
"ARTH + HTN + DIA",
"ARTH + HTN + CAN",
"ARTH + HTN + LUNG",
"ARTH + HTN + DIA + HRT",
"Other combination of 2+ conditions"
)),
low_ci = est-(1.96*se),
up_ci = est+(1.96*se),
# i_or_s = case_when(param_header == "DEP_I.ON" ~ "i",
#                    param_header == "DEP_S.ON" ~ "s")
)
All_Output <- readModels("C:/Users/Nicholas Bishop/Box/MEMORABLE project BOX/Kealie/mplus/dep model analysis/updated 091724")
warnings()
combined_model_building2 <- do.call(dplyr::bind_rows, lapply(1:length(All_Output), function(m) {
df <- All_Output[[m]]$parameters$unstandardized
df$model <- names(All_Output)[m]
return(df)
}))
# baseline depressive symptoms estimates
mplus_est_fp <- combined_model_building2 %>% dplyr::filter(model == "X1..dep.lgm.mm.combo.emmeans.int.v2.out" &
paramHeader %in% c("New.Additional.Parameters") &
param %in% c("N_C_E",
"A_E",
"H_E",
"O_S_E",
"H_A_E",
"A_HR_A_E",
"H_D_A_E",
"H_D_HR_A",
"H_C_A_E",
"H_D_E",
"HR_A_E",
"C_A_E",
"H_L_A_E",
"O_CO_E"
)) %>%
dplyr::select(paramHeader, param, est, se) %>%
clean_names(., "snake") %>%
dplyr::mutate(param = case_when(param == "N_C_E" ~ "No condition",
param == "A_E" ~ "ARTH only",
param == "H_E" ~ "HTN only",
param == "O_S_E" ~ "Other single condition",
param == "H_A_E" ~ "ARTH + HTN",
param == "A_HR_A_E" ~ "ARTH + HTN + HRT",
param == "H_D_A_E" ~ "ARTH + HTN + DIA",
param == "H_D_HR_A" ~ "ARTH + HTN + DIA + HRT",
param == "H_C_A_E" ~ "ARTH + HTN + CAN",
param == "H_D_E" ~ "HTN + DIA",
param == "HR_A_E" ~ "ARTH + HRT",
param == "C_A_E" ~ "ARTH + CAN",
param == "H_L_A_E" ~ "ARTH + HTN + LUNG",
param == "O_CO_E" ~ "Other combination of 2+ conditions",
TRUE ~ param),
param = factor(param, levels = c("No condition",
"ARTH only",
"HTN only",
"Other single condition",
"ARTH + HTN",
"HTN + DIA",
"ARTH + HRT",
"ARTH + CAN",
"ARTH + HTN + HRT",
"ARTH + HTN + DIA",
"ARTH + HTN + CAN",
"ARTH + HTN + LUNG",
"ARTH + HTN + DIA + HRT",
"Other combination of 2+ conditions"
)),
low_ci = est-(1.96*se),
up_ci = est+(1.96*se),
# i_or_s = case_when(param_header == "DEP_I.ON" ~ "i",
#                    param_header == "DEP_S.ON" ~ "s")
)
fp1_mp <- mplus_est_fp %>%
ggplot(aes(x=param, y=est, ymin=low_ci, ymax=up_ci)) +
geom_pointrange() +
scale_x_discrete(limits=rev) +
# geom_hline(yintercept=0, lty=2) +  # add a dotted line at x=1 after flip
coord_flip() +  # flip coordinates (puts labels on y axis)
xlab("") + ylab("Estimated number of depressive symptoms with 95% CI, 2012") +
theme_bw() + theme(text=element_text(size=16, family="serif")) +
ylim(1, 3)
fp1_mp
View(mplus_est_fp)
